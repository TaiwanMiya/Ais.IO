DES (Data Encryption Standard)

    1. CBC (Cipher Block Chaining)

        - [原理與規則]
            - 每個明文塊在加密前與前一個密文塊進行異或操作。
            - 第一個塊使用初始化向量 (IV) 進行異或，IV 需唯一但不必保密。
            - 解密過程通過反向操作恢復明文。

        - [應用]
            - 適合文件加密和批量處理多塊數據的情況。
            - 廣泛應用於傳統安全協議中。

        - [安全性]
            - 如果 IV 無法預測，相對安全，但對完整性沒有內置保護，容易受到填充攻擊 (padding oracle attack)。

        - [輸入]
            - Key : 2DES 或 3DES 密鑰，大小固定 (有效長度 112 或 168 bits, 加上校驗位的長度 128 或 192 bits)。
            - IV : 初始化向量，與塊大小相同 (64 bits)。
            - Padding : 使用 PKCS#7 填充，如果明文長度不是塊大小的整數倍。
            - Plain Text : 待加密的數據。

        - [輸出]
            - Cipher Text : 加密後的密文，包含填充，大小為塊大小的整數倍。

    2. CFB (Cipher Feedback)

        - [原理與規則]
            - IV 經過加密後與明文進行異或，產生密文。
            - 密文的一部分回饋給加密過程，成為下一輪的輸入。
            - 支援處理小於一個塊大小的數據。

        - [應用]
            - 適用於需要處理流數據的場景，如即時通信。

        - [安全性]
            - 如果 IV 重複或可預測，安全性會降低。
            - 沒有內置的完整性保護。

        - [輸入]
            - Key : 2DES 或 3DES 密鑰，大小固定 (有效長度 112 或 168 bits, 加上校驗位的長度 128 或 192 bits)。
            - IV : 初始化向量，大小為 64 bits。
            - Segment Size : 段大小，可為 1、8 或 64 bits。
            - Plain Text : 待加密的數據。

        - [輸出]
            - Cipher Text : 加密後的密文，與明文大小相同。

    3. OFB (Output Feedback)

        - [原理與規則]
            - IV 經過加密後生成密碼流，該密碼流與明文進行異或得到密文。
            - 密碼流的生成與明文無關，可提前計算。

        - [應用]
            - 適用於硬件或軟件中流數據加密的場景，如電話通信。

        - [安全性]
            - 和 CTR 類似，輸出流的唯一性依賴於 IV。
            - 沒有完整性保護。

        - [輸入]
            - Key : 2DES 或 3DES 密鑰，大小固定 (有效長度 112 或 168 bits, 加上校驗位的長度 128 或 192 bits)。
            - IV : 初始化向量，大小為 64 bits。
            - Plain Text : 待加密的數據。

        - [輸出]
            - Cipher Text : 加密後的密文，與明文大小相同。

    4. ECB (Electronic Codebook)

        - [原理與規則]
            - 每個明文塊獨立加密，無需依賴前後塊。
            - 不使用 IV。

        - [應用]
            - 適合單塊數據加密。
            - 不適合需要加密多塊相關數據的情況。

        - [安全性]
            - 安全性較低，容易暴露模式或數據重複性 (如圖像加密中暴露結構)。
            - 不推薦使用。

        - [輸入]
            - Key : 2DES 或 3DES 密鑰，大小固定 (有效長度 112 或 168 bits, 加上校驗位的長度 128 或 192 bits)。
            - Padding : 使用 PKCS#7 填充，如果明文長度不是塊大小的整數倍。
            - Plain Text : 待加密的數據。

        - [輸出]
            - Cipher Text : 加密後的密文，大小為塊大小的整數倍。

    5. WRAP (Key Wrap Mode)

        - [原理與規則]
            - 專為密鑰管理設計，用於封裝和保護對稱密鑰。
            - 使用 2DES 或 3DES WRAP 算法進行加密操作，保證密鑰的機密性和完整性。

        - [應用]
            - 適用於密鑰分發和密鑰存儲場景。
            - 用於保護敏感數據中的加密密鑰。

        - [安全性]
            - 提供機密性和完整性保護，確保密鑰不被篡改或洩露。
            - 依賴於加密密鑰的強度和唯一性。

        - [輸入]
            - Key : 待保護的密鑰，大小為 64 bits 的倍數。
            - Key Encryption Key (KEK) : 2DES 或 3DES 密鑰，大小固定 (有效長度 112 或 168 bits, 加上校驗位的長度 128 或 192 bits)。

        - [輸出]
            - Wrapped Key : 加密後的密鑰。

        - [特殊規定]
            - 設計用於對敏感密鑰進行封裝與保護，適用於密鑰管理。

# 總結與選擇建議
    CBC/CFB/OFB : 適合舊系統和需要向後兼容的特殊場景，如文件加密或實時流數據處理。但由於其對完整性保護不足，較少推薦於現代應用。
    ECB : 避免使用，因為它無法隱藏數據模式，容易暴露加密內容的結構。
    WRAP : 專為密鑰管理設計，用於安全分發和保護密鑰。適合需要保障密鑰完整性與機密性的場景。

    *2DES/3DES*
        適用於對舊系統的兼容需求。
        2DES 的安全性已被證明不足，建議僅使用 3DES。
        3DES 仍然支持現代加密需求，但效率低，逐漸被更高效的算法 (如 AES) 取代。

### 排行 ###

以下是針對 **DES 模式**設計的排行榜，基於安全度（Safety）、實現複雜度（Complex）、和廣泛度（Widely）進行評估。考慮到 **DES 的局限性** 和其在現代應用中的稀有程度，評分主要反映其相對價值。

---

### 排行 ###

    1. Safety   = 安全度  
    2. Complex  = 複雜度  
    3. Widely   = 廣泛度  

    |-------|-----------|-----------|-----------|
    |       |   Safety  |   Complex |   Widely  |
    |-------|-----------|-----------|-----------|
    |   1   |   WRAP    |   WRAP    |   CBC     |
    |-------|-----------|-----------|-----------|
    |   2   |   CBC     |   CBC     |   WRAP    |
    |-------|-----------|-----------|-----------|
    |   3   |   CFB     |   CFB     |   CFB     |
    |-------|-----------|-----------|-----------|
    |   4   |   OFB     |   OFB     |   OFB     |
    |-------|-----------|-----------|-----------|
    |   5   |   ECB     |   ECB     |   ECB     |
    |-------|-----------|-----------|-----------|

### 整體評分 ###

    以下是根據 安全性、複雜度 (以實現效率和易用性衡量)、廣泛度 (應用頻率和適用範圍) 進行的整體評分 (1~10 級)，並說明評分理由。

    1. Mode     = 加密模式
    2. Safety   = 安全性
    3. Complex  = 複雜度
    4. Widely   = 廣泛度
    5. Score    = 總分
    6. Reason   = 評分理由

    | Mode | Safety (40%) | Complex (30%)| Widely (30%) | Score (1~10)  | Reason
    |------|--------------|--------------|--------------|---------------|----------------------------------------------------------------
    | WRAP | 6            | 6            | 5            | 5.7           | 專用於密鑰管理，安全性較高，但應用範圍狹窄，且 3DES 加密性能較低。
    | CBC  | 5            | 6            | 6            | 5.6           | 舊系統中的常見模式，適合分塊加密，但安全性受限於 IV 的管理和填充攻擊風險。
    | CFB  | 4            | 6            | 4            | 4.6           | 流加密模式，適用於舊式即時通訊，安全性不足，性能相對較差，應用逐漸減少。
    | OFB  | 4            | 6            | 3            | 4.3           | 與 CFB 類似，但模式更簡單，應用範圍更窄，且不提供完整性保護。
    | ECB  | 2            | 8            | 2            | 3.4           | 簡單高效，但安全性極差，僅適用於無敏感數據的特殊場景 (如數據對齊測試)。

    ** 評分公式 **
    - 總分 = (安全性評分 × 40%) + (複雜度評分 × 30%) + (廣泛度評分 × 30%)
    - 安全性 : 根據抗攻擊能力、完整性保護和唯一性要求評估。
    - 複雜度 : 考慮實現的難度、效率，以及用戶友好性。
    - 廣泛度 : 依據當前技術標準和實際應用頻率。
